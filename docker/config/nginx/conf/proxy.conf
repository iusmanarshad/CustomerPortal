# originals4fans.com, app.originals4fans.com, ws.originals4fans.com, sp.originals4fans.com, _
server {
	listen      80;
	listen      [::]:80;
	server_name originals4fans.com www.originals4fans.com app.originals4fans.com www.app.originals4fans.com ws.originals4fans.com www.ws.originals4fans.com sp.originals4fans.com dev.originals4fans.com www.dev.originals4fans.com app.dev.originals4fans.com www.app.dev.originals4fans.com ws.dev.originals4fans.com www.ws.dev.originals4fans.com sp.dev.originals4fans.com _;
	include     /etc/nginx/includes/letsencrypt.conf;
	location / {
        return  301 https://$host$request_uri;
    }
}

# App / Site (PROD)
server {
    listen      443 ssl http2;
    listen      [::]:443 ssl http2;
    server_name app.originals4fans.com www.app.originals4fans.com;
    root	    /var/www/backend/public;
    index       index.php index.html;

    fastcgi_buffers 16 16k;
    fastcgi_buffer_size 32k;

    include     /etc/nginx/includes/headers.conf;
    include     /etc/nginx/includes/default.conf;
    include     /etc/nginx/includes/gzip.conf;
    include     /etc/nginx/includes/ssl.conf;

    # Path for SSL config/key/certificate
    ssl_certificate     /etc/nginx/certs/live/originals4fans.com/fullchain.pem;
    ssl_certificate_key /etc/nginx/certs/live/originals4fans.com/privkey.pem;

    location / {
        include /etc/nginx/includes/proxy.conf;
        proxy_pass http://o4f_web_prod;
    }

    error_page  404 /index.php;
    error_log   /var/log/nginx/app_error.log debug;
    access_log	off;
}

# App / Site (DEV)
server {
    listen      443 ssl http2;
    listen      [::]:443 ssl http2;
    server_name app.dev.originals4fans.com www.app.dev.originals4fans.com;
    root	    /var/www/backend/public;
    index       index.php index.html;

    fastcgi_buffers 16 16k;
    fastcgi_buffer_size 32k;

    include     /etc/nginx/includes/headers.conf;
    include     /etc/nginx/includes/default.conf;
    include     /etc/nginx/includes/gzip.conf;
    include     /etc/nginx/includes/ssl.conf;

    # Path for SSL config/key/certificate
    ssl_certificate     /etc/nginx/certs/live/originals4fans.com/fullchain.pem;
    ssl_certificate_key /etc/nginx/certs/live/originals4fans.com/privkey.pem;

    location / {
        include /etc/nginx/includes/proxy.conf;
        proxy_pass http://o4f_web_dev;
    }

    error_page  404 /index.php;
    error_log   /var/log/nginx/app_dev_error.log debug;
    access_log	off;
}

# Frontend / Site (PROD)
server {
    listen      443 ssl http2;
    listen      [::]:443 ssl http2;
    server_name originals4fans.com www.originals4fans.com;

    ssl_certificate     /etc/nginx/certs/live/originals4fans.com/fullchain.pem;
    ssl_certificate_key /etc/nginx/certs/live/originals4fans.com/privkey.pem;

    location / {
        proxy_pass http://o4f_fe_prod;
        proxy_redirect off;
        proxy_http_version 1.1;
        proxy_set_header X-Real-Ip $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $host;
        proxy_set_header REMOTE_ADDR $remote_addr;
    }

    error_log   /var/log/nginx/frontend_prod_error.log debug;
    access_log	off;
}

# Frontend / Site (DEV)
server {
    listen      443 ssl http2;
    listen      [::]:443 ssl http2;
    server_name dev.originals4fans.com www.dev.originals4fans.com;

    ssl_certificate     /etc/nginx/certs/live/originals4fans.com/fullchain.pem;
    ssl_certificate_key /etc/nginx/certs/live/originals4fans.com/privkey.pem;

    location / {
        proxy_pass http://o4f_fe_dev;
        proxy_redirect off;
        proxy_http_version 1.1;
        proxy_set_header X-Real-Ip $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $host;
        proxy_set_header REMOTE_ADDR $remote_addr;
    }

    error_log   /var/log/nginx/frontend_dev_error.log debug;
    access_log	off;
}

# Sockets (PROD)
server {
    listen      443 ssl http2;
    listen      [::]:443 ssl http2;
    server_name ws.originals4fans.com www.ws.originals4fans.com;

    # Path for SSL config/key/certificate
    ssl_certificate     /etc/nginx/certs/live/originals4fans.com/fullchain.pem;
    ssl_certificate_key /etc/nginx/certs/live/originals4fans.com/privkey.pem;

    location / {
        proxy_pass          http://o4f_sp_prod:6001;
        proxy_set_header    Upgrade $http_upgrade;
        proxy_set_header    Connection 'upgrade';
    }

    error_log   /var/log/nginx/socket_prod_error.log debug;
    access_log	off;
}

# Sockets (DEV)
server {
    listen      443 ssl http2;
    listen      [::]:443 ssl http2;
    server_name ws.dev.originals4fans.com www.ws.dev.originals4fans.com;

    # Path for SSL config/key/certificate
    ssl_certificate     /etc/nginx/certs/live/originals4fans.com/fullchain.pem;
    ssl_certificate_key /etc/nginx/certs/live/originals4fans.com/privkey.pem;

    location / {
        proxy_pass          http://o4f_sp_dev:6001;
        proxy_set_header    Upgrade $http_upgrade;
        proxy_set_header    Connection 'upgrade';
    }

    error_log   /var/log/nginx/socket_dev_error.log debug;
    access_log	off;
}

# Supervisor (PROD)
server {
    listen      443 ssl http2;
    server_name sp.originals4fans.com;
    root	    /var/www;

    include     /etc/nginx/includes/headers.conf;
    include     /etc/nginx/includes/default.conf;
    include     /etc/nginx/includes/ssl.conf;

    # Path for SSL config/key/certificate
    ssl_certificate     /etc/nginx/certs/live/originals4fans.com/fullchain.pem;
    ssl_certificate_key /etc/nginx/certs/live/originals4fans.com/privkey.pem;

    location / {
        proxy_pass      http://o4f_sp_prod:9000;
        include         /etc/nginx/includes/proxy.conf;
    }

    error_page  404 /index.php;
    error_log   /var/log/nginx/sp_prod_error.log debug;
    access_log	off;
}

# Supervisor (DEV)
server {
    listen      443 ssl http2;
    server_name sp.dev.originals4fans.com;
    root	    /var/www;

    include     /etc/nginx/includes/headers.conf;
    include     /etc/nginx/includes/default.conf;
    include     /etc/nginx/includes/ssl.conf;

    # Path for SSL config/key/certificate
    ssl_certificate     /etc/nginx/certs/live/originals4fans.com/fullchain.pem;
    ssl_certificate_key /etc/nginx/certs/live/originals4fans.com/privkey.pem;

    location / {
        proxy_pass      http://o4f_sp_dev:9000;
        include         /etc/nginx/includes/proxy.conf;
    }

    error_page  404 /index.php;
    error_log   /var/log/nginx/sp_dev_error.log debug;
    access_log	off;
}

# Default
server {
    listen      443 ssl default_server;
    server_name _;
    root        /var/www/html;

    include     /etc/nginx/includes/headers.conf;
    include     /etc/nginx/includes/default.conf;
    include     /etc/nginx/includes/ssl.conf;
    include     /etc/nginx/includes/default_server.conf;

    # Path for SSL config/key/certificate
    ssl_certificate     /etc/nginx/certs/live/originals4fans.com/fullchain.pem;
    ssl_certificate_key /etc/nginx/certs/live/originals4fans.com/privkey.pem;

    error_log  /var/log/nginx/default_error.log debug;
    access_log	off;
}
